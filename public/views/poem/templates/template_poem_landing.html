<div ng-include="model.templates.navHeader"></div>

<div class="container-fluid">
    <div class="alert-danger" ng-show="model.errorMsg">{{model.errorMsg}}</div>
    <div class="alert-success" ng-show="model.successMsg">{{model.successMsg}}</div>
    <div ng-include="model.templates.poem"></div>

    <div ng-if="model.poem._id">
        <label>Translations</label>
        <!-- TODO bring out into separate template -->
        <ul class="list-group">
            <li class="list-group-item" ng-repeat="translation in model.translations">
                <div><b>{{translation.title || ""}}</b></div>
                <a href="#!/profile/{{translation.author._id}}">
                    <i>{{translation.author.username}}</i>
                </a>
                <div ng-repeat="line in translation.lines | limitTo: model.maxLines track by $index">{{line}}</div>
                <div ng-if="translation.lines.length > model.maxLines">...</div>
                <div>{{translation.lines.length}}</div>
                <a href="#!/poem/{{model.poem._id}}/translation/{{translation._id}}">
                    Go to Translation
                </a>
                <br/>
            </li>
        </ul>
    </div>

    <a ng-if="model.poem._id"
       class="btn btn-success btn-block"
       ng-click="model.addTranslation()">Add Translation</a>
    <!-- TODO what happens when poem with translations is deleted? -->
    <a ng-if="model.poemEditFlag" class="btn btn-danger btn-block" ng-click="model.deletePoem()">Delete Poem</a>
</div>

<div ng-include="model.templates.navFooter"></div>